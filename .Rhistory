inputId = "valor_varianza",
label = "Establezca un valor de la varianza",
value = 0.5, min = 0, max = 500, step = 0.1
),
sliderInput(
inputId = "valor_k",
label = "Establezca el valor de k para el algoritmo KNN que nos servirá para imputar los valores de expresión nulos",
value = 5, min = 1, max = 10, step = 1
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "preprocesado_mirnas",
label = "Ejecutar preprocesado con estos valores",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
)
)
),
#### Análisis de expresión diferencial (ui) ####
tabItem(tabName = "expr_dif",
fluidRow(
box(
width = 4, title = "Opciones para el Volcano Plot", status = "info", solidHeader = TRUE,
radioButtons(
inputId = "muestras",
label = "¿Qué conjunto de muestras desea utilizar para el análisis?",
choices = list("Totales", "Pareadas")
),
numericInput(
inputId = "logFC",
label = "Establece el valor mínimo del log Fold Change en valor absoluto",
value = 1.5, min = 0, max = 5, step = 0.1
),
numericInput(
inputId = "p_valor_adj",
label = "Establece el p-valor ajustado (por defecto 10e-10 ó 1e-9)",
value = 10e-10, min = 0, max = 1, step = 10e-9
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "analisis_dea",
label = "Ejecutar análisis",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
),
tabBox(
width = 8, title = "Resultados del análisis",
tabPanel("Gráfica",
plotOutput("volcano_plot")
),
tabPanel("miRNAs que pasan ambos filtros",
DT::dataTableOutput("mirnas_filtrados")
)
)
)
),
#### Análisis de supervivencia (ui) ####
tabItem(tabName = "surv",
fluidRow(
box(
width = 4, title = "Parámetros modelo de Cox", status = "info", solidHeader = TRUE,
numericInput(
inputId = "p_valor",
label = "Establece el p-valor a usar",
value = 0.05, min = 0, max = 1, step = 0.01
),
sliderInput(
inputId = "minHR",
label = "HR mínimo",
value = 0.85, min = 0, max = 1, step = 0.01
),
tags$div(class = "slider-custom",
sliderInput(
inputId = "maxHR",
label = "HR máximo",
value = 1.15, min = 1, max = 2, step = 0.01
)
),
tags$div(
style = "text-align: center;",
helpText("Se escogerán los miRNAs cuyo HR quede dentro de los intervalos azules")
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "analisis_cox",
label = "Ejecutar análisis",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
),
box(
width = 8, title = "Lista de miRNAs filtrados", status = "primary", solidHeader = TRUE,
uiOutput("mirnas")
),
box(
width = 8, title = "Resultados", status = "success", solidHeader = TRUE,
plotOutput("graficas")
)
),
)
)
)
)
shiny::runApp('Archivos_R')
ui <- dashboardPage(
dashboardHeader(title = "TCGA-ML Explorer"),
dashboardSidebar(
sidebarMenu(
menuItem("Introducción", tabName = "intro", icon = icon("book-open")),
menuItem("Preprocesado",
menuSubItem("Clínico", tabName = "pre_clinico", icon = icon("stethoscope")),
menuSubItem("miRNAs", tabName = "pre_mirna", icon = icon("dna"))
),
menuItem("Expresión diferencial", tabName = "expr_dif", icon = icon("dna")),
menuItem("Análisis de supervivencia", tabName = "surv", icon = icon("line-chart")),
menuItem("Enriquecimiento", tabName = "enrich", icon = icon("chart-bar")),
menuItem("Clustering", tabName = "cluster", icon = icon("circle-nodes"))
)
),
dashboardBody(
tags$head(
tags$style(HTML("
.slider-custom .js-irs-1 .irs-bar{
background: #f5f5f5;
height: 9.5px;
}
.slider-custom .js-irs-1 .irs-line{
background: #3c8dbc;
height: 8px;
}
"))
),
tabItems(
#### Introducción (ui) ####
tabItem(tabName = "intro",
fluidRow(
box(
width = 8,
title = "Descarga de datos del TCGA",
status = "info",
solidHeader = TRUE,
selectInput("project", "Selecciona un proyecto TCGA:",
choices = c("TCGA-HNSC", "TCGA-CHOL")),
tags$div(style = "text-align: center;",
actionButton("download",
"Descargar datos",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;")
)
),
box(
width = 4,
title = "Estado de descarga",
status = "primary",
solidHeader = TRUE,
textOutput("status")
)
)
),
#### Preprocesado mirnas (ui) ####
tabItem(tabName = "pre_mirna",
fluidRow(
box(
width = 12, title = "Parámetros a modificar en el preprocesado", status = "info", solidHeader = TRUE,
numericInput(
inputId = "porcentaje_max_nulos",
label = "Establezca un porcentaje (del 0 al 1) de valores nulos",
value = 0.5, min = 0, max = 1, step = 0.01
),
numericInput(
inputId = "porcentaje_max_na",
label = "Establezca un porcentaje (del 0 al 1) de valores NA",
value = 0.4, min = 0, max = 1, step = 0.01
),
numericInput(
inputId = "valor_varianza",
label = "Establezca un valor de la varianza",
value = 0.5, min = 0, max = 500, step = 0.1
),
sliderInput(
inputId = "valor_k",
label = "Establezca el valor de k para el algoritmo KNN que nos servirá para imputar los valores de expresión nulos",
value = 5, min = 1, max = 10, step = 1
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "preprocesado_mirnas",
label = "Ejecutar preprocesado con estos valores",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
)
)
),
#### Análisis de expresión diferencial (ui) ####
tabItem(tabName = "expr_dif",
fluidRow(
box(
width = 4, title = "Opciones para el Volcano Plot", status = "info", solidHeader = TRUE,
radioButtons(
inputId = "muestras",
label = "¿Qué conjunto de muestras desea utilizar para el análisis?",
choices = list("Totales", "Pareadas")
),
numericInput(
inputId = "logFC",
label = "Establece el valor mínimo del log Fold Change en valor absoluto",
value = 1.5, min = 0, max = 5, step = 0.1
),
numericInput(
inputId = "p_valor_adj",
label = "Establece el p-valor ajustado (por defecto 10e-10 ó 1e-9)",
value = 10e-10, min = 0, max = 1, step = 10e-9
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "analisis_dea",
label = "Ejecutar análisis",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
),
tabBox(
width = 8, title = "Resultados del análisis",
tabPanel("Gráfica",
plotOutput("volcano_plot")
),
tabPanel("miRNAs que pasan ambos filtros",
DT::dataTableOutput("mirnas_filtrados")
)
)
)
),
#### Análisis de supervivencia (ui) ####
tabItem(tabName = "surv",
fluidRow(
box(
width = 4, title = "Parámetros modelo de Cox", status = "info", solidHeader = TRUE,
numericInput(
inputId = "p_valor",
label = "Establece el p-valor a usar",
value = 0.05, min = 0, max = 1, step = 0.01
),
sliderInput(
inputId = "minHR",
label = "HR mínimo",
value = 0.85, min = 0, max = 1, step = 0.01
),
tags$div(class = "slider-custom",
sliderInput(
inputId = "maxHR",
label = "HR máximo",
value = 1.15, min = 1, max = 2, step = 0.01
)
),
tags$div(
style = "text-align: center;",
helpText("Se escogerán los miRNAs cuyo HR quede dentro de los intervalos azules")
),
tags$div(style = "text-align: center;",
actionButton(
inputId = "analisis_cox",
label = "Ejecutar análisis",
style = "background-color: #4CAF50; color: white; font-weight: bold; border: none;"
)
)
),
box(
width = 8, title = "Lista de miRNAs filtrados", status = "primary", solidHeader = TRUE,
uiOutput("mirnas")
),
box(
width = 8, title = "Resultados", status = "success", solidHeader = TRUE,
plotOutput("graficas")
)
),
)
)
)
)
runApp('Archivos_R')
crea_df_mirnas <- function(project){
metaMatrix.MIR <- gdcParseMetadata(project.id = project,
data.type  = 'miRNAs',
write.meta = FALSE)
return(metaMatrix.MIR)
}
descarga_mirnas <- function(project){
isoform_miRNAs_dir <- paste('metadatos', project, 'miRNAs', sep='/')
# Download miRNA data
gdcRNADownload(project.id     = project,
data.type      = 'miRNAs',
write.manifest = FALSE,
method         = 'gdc-client',
directory      = isoform_miRNAs_dir)
# Limpieza: borrar carpetas vacías en el WD
vacias <- list.dirs(getwd(), recursive = FALSE, full.names = TRUE)
vacias <- vacias[sapply(vacias,
function(x) length(list.files(x,
all.files = TRUE,
no.. = TRUE)) == 0)]
if (length(vacias) > 0){
unlink(vacias, recursive = TRUE)
}
return(metaMatrix.MIR)
}
crea_df_mirnas <- function(project){
metaMatrix.MIR <- gdcParseMetadata(project.id = project,
data.type  = 'miRNAs',
write.meta = FALSE)
return(metaMatrix.MIR)
}
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
volcano <- function(tabla_resultados, muestras_escogidas, umbral_logFC, umbral_pvalor_ajustado){
if (muestras_escogidas == "Totales"){
titulo <- "Volcano Plot para el total de muestras"
}else if (muestras_escogidas == "Pareadas"){
titulo <- "Volcano Plot para el conjunto de muestras pareadas"
}
print(EnhancedVolcano(tabla_resultados,
title = titulo,
lab = rownames(tabla_resultados),
x = 'logFC',
y = 'adj.P.Val',
FCcutoff = umbral_logFC,
pCutoff = umbral_pvalor_ajustado))
}
runApp('Archivos_R')
shiny::runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
runApp('Archivos_R')
shiny::runApp('Archivos_R')
shiny::runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
runApp('C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard')
setwd("C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard")
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
setwd("C:/Users/Usuario/OneDrive/Escritorio/TCGA-ML-Dashboard")
shiny::runApp()
runApp()
runApp()
runApp()
